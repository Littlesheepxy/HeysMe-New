# 增量模式测试完整指南

## 🎯 **测试平台概览**

我已经为您创建了一个完整的增量模式测试系统，包括测试页面、示例项目和API接口。您可以通过多种方式测试新的Anthropic标准格式工具和增量编辑功能。

## 📍 **测试入口**

### 1. **主要测试页面** 
```
访问地址: http://localhost:3000/test-incremental-tools
```

这是一个功能完整的测试界面，包含：
- ✅ 预设测试场景
- ✅ 自定义提示词测试  
- ✅ 实时工具调用监控
- ✅ 详细的执行统计
- ✅ 真实API/模拟模式切换

### 2. **API测试接口**
```
端点: POST /api/test-incremental
健康检查: GET /api/test-incremental
```

## 🧪 **测试场景**

### **预设场景1: React组件修改**
- **目标**: 测试样式和文本修改
- **示例文件**: `test-project/components/Hero.tsx`
- **测试提示词**: "将Hero组件的标题颜色改为紫色，字体大小改为2xl"
- **预期工具**: `read_file` → `edit_file`

### **预设场景2: 新组件创建**  
- **目标**: 测试从零创建组件
- **示例文件**: `test-project/pages/index.tsx`
- **测试提示词**: "创建一个ContactForm组件，包含邮箱和消息输入框"
- **预期工具**: `write_file` → `read_file` → `edit_file`

### **预设场景3: 项目结构分析**
- **目标**: 测试代码搜索和分析
- **示例文件**: 多个包含useState的组件
- **测试提示词**: "分析项目结构，查找所有使用useState的组件"
- **预期工具**: `get_file_structure` → `search_code` → `list_files`

### **预设场景4: 复杂重构**
- **目标**: 测试多文件操作
- **示例文件**: `test-project/components/Button.tsx`
- **测试提示词**: "将Tailwind样式改为CSS Modules"
- **预期工具**: `read_file` → `edit_file` → `write_file` → `search_code`

## 🚀 **如何开始测试**

### **步骤1: 启动测试页面**
```bash
# 确保开发服务器正在运行
npm run dev

# 访问测试页面
http://localhost:3000/test-incremental-tools
```

### **步骤2: 选择测试模式**
- **真实模式**: 使用实际的CodingAgent和工具调用
- **模拟模式**: 使用预设的工具调用序列进行快速测试

### **步骤3: 运行测试**
1. 选择一个预设场景
2. 点击"运行测试"
3. 观察实时工具调用过程
4. 查看执行结果和统计

### **步骤4: 自定义测试**
1. 在"自定义测试"区域输入提示词
2. 点击"运行自定义测试"
3. 分析结果并记录发现

## 📊 **测试指标详解**

### **工具调用准确性**
- ✅ **工具选择正确**: AI是否选择了最合适的工具
- ✅ **参数格式正确**: 是否通过Anthropic标准验证
- ✅ **调用顺序合理**: 工具执行的逻辑顺序
- ✅ **执行成功率**: 工具调用的成功比例

### **执行性能**
- ⏱️ **平均执行时间**: 每个工具的响应时间
- 📈 **总体完成时间**: 整个测试场景的耗时
- 🔄 **并发处理能力**: 同时处理多个工具调用

### **质量评估**
- 🎯 **功能准确性**: 修改是否达到预期效果
- 🔧 **代码质量**: 生成的代码是否符合标准
- 📝 **错误处理**: 错误信息是否清晰有用

## 📁 **示例项目结构**

```
test-project/
├── components/           # 测试组件
│   ├── Hero.tsx         # 首页横幅 (样式修改测试)
│   ├── Button.tsx       # 通用按钮 (重构测试)  
│   └── Card.tsx         # 卡片容器 (功能扩展测试)
├── pages/               # 页面文件
│   └── index.tsx        # 主页面 (状态管理测试)
└── README.md            # 详细说明文档
```

## 🎯 **推荐测试流程**

### **第一轮: 基础功能验证**
1. **样式修改测试**
   ```
   将Hero组件的背景颜色改为渐变色（从蓝色到紫色）
   ```

2. **文本更新测试**
   ```
   修改Hero组件的标题为"欢迎使用AI代码助手"
   ```

3. **属性添加测试**
   ```
   为Button组件添加loading状态支持
   ```

### **第二轮: 中级功能测试**
1. **组件创建测试**
   ```
   创建一个Modal组件，支持打开关闭和自定义内容
   ```

2. **状态管理测试**
   ```
   在首页添加一个计数器，包含增加、减少和重置功能
   ```

3. **样式系统测试**
   ```
   将Button组件的Tailwind类名改为CSS变量
   ```

### **第三轮: 高级功能测试**
1. **项目分析测试**
   ```
   分析整个项目，列出所有可以优化的地方
   ```

2. **重构测试**
   ```
   将所有组件迁移到TypeScript严格模式
   ```

3. **性能优化测试**
   ```
   为所有组件添加React.memo优化
   ```

## 🐛 **常见问题处理**

### **API连接问题**
如果真实API模式出现错误：
1. 检查开发服务器是否正常运行
2. 查看浏览器控制台的错误信息
3. 切换到模拟模式继续测试

### **工具调用失败**
如果某个工具调用失败：
1. 检查参数是否符合JSON Schema
2. 查看详细的错误信息
3. 验证文件路径是否正确

### **执行超时**
如果测试执行时间过长：
1. 检查网络连接
2. 减少测试文件的复杂度
3. 优化提示词的明确度

## 📝 **测试记录模板**

每次测试后，建议记录以下信息：

```markdown
### 测试记录 - [日期]

#### 场景: [测试场景名称]
- **提示词**: "[具体的测试指令]"
- **模式**: [真实API/模拟模式]
- **执行时间**: [总时间]ms

#### 工具调用序列:
1. get_file_structure ✅ 500ms
2. read_file ✅ 300ms  
3. edit_file ✅ 700ms

#### 结果评估:
- ✅ 工具选择正确
- ✅ 参数格式通过验证
- ✅ 代码修改准确
- ⚠️ 执行时间略长

#### 发现的问题:
- [具体问题描述]

#### 改进建议:
- [具体建议]
```

## 🔧 **扩展测试**

### **添加新的测试场景**
1. 在`TEST_SCENARIOS`数组中添加新场景
2. 准备相应的示例文件
3. 定义预期的工具调用序列

### **创建复杂测试用例**
1. 准备多文件的复杂项目结构
2. 设计跨文件的修改任务
3. 测试AI的项目理解能力

### **性能压力测试**
1. 创建大型文件的修改任务
2. 测试并发工具调用
3. 评估系统的稳定性

## 📞 **获取帮助**

如果在测试过程中遇到问题：

1. **检查测试页面的实时日志** - 查看详细的工具调用过程
2. **查看浏览器控制台** - 获取客户端错误信息  
3. **检查服务器日志** - 获取后端执行详情
4. **参考示例项目** - `test-project/` 目录中的文件示例

## 🎉 **测试完成后**

完成测试后，您将获得：

- ✅ **工具调用准确性评估** - 各工具的执行成功率
- ✅ **性能基准数据** - 响应时间和吞吐量统计  
- ✅ **质量评估报告** - 代码修改的准确性分析
- ✅ **改进建议清单** - 进一步优化的方向

这个测试系统将帮助您全面验证新的Anthropic标准格式工具的效果，确保增量编辑功能达到预期的质量标准。
