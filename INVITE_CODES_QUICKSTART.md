# ğŸš€ é‚€è¯·ç åŠŸèƒ½å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸ“ é—®é¢˜ä¿®å¤

âœ… **å·²ä¿®å¤ PostgreSQL æ•°ç»„è¯­æ³•é”™è¯¯**
- åŸé”™è¯¯: `projects @> '["admin"]'` 
- å·²ä¿®å¤: `projects @> ARRAY['admin']`
- ä½¿ç”¨ä¿®å¤ç‰ˆæ–‡ä»¶: `sql/invite-codes-schema-fixed.sql`

## ğŸ› ï¸ 3åˆ†é’Ÿå¿«é€Ÿè®¾ç½®

### 1. æ‰§è¡Œæ•°æ®åº“è¿ç§»
åœ¨ Supabase Dashboard â†’ SQL Editor ä¸­æ‰§è¡Œï¼š

```sql
-- å¤åˆ¶ç²˜è´´ sql/invite-codes-schema-fixed.sql çš„å…¨éƒ¨å†…å®¹
-- ä¸€æ¬¡æ€§æ‰§è¡Œï¼Œä¼šè‡ªåŠ¨åˆ›å»ºæ‰€æœ‰è¡¨å’Œç­–ç•¥
```

### 2. è®¾ç½®ç®¡ç†å‘˜æƒé™

#### ğŸ”§ æ–¹æ³•1: ä½¿ç”¨è°ƒè¯•é¡µé¢ï¼ˆæ¨èï¼‰
1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨: `npm run dev`
2. ç™»å½•æˆ–æ³¨å†Œä¸€ä¸ªè´¦æˆ·
3. è®¿é—® `http://localhost:3000/debug-admin`
4. å¤åˆ¶æ˜¾ç¤ºçš„ SQL è¯­å¥
5. åœ¨ Supabase SQL Editor ä¸­æ‰§è¡Œ

#### ğŸ“ æ–¹æ³•2: æ‰‹åŠ¨è®¾ç½®
åœ¨ Supabase â†’ Table Editor â†’ users è¡¨ä¸­ï¼š

```sql
-- æ–¹æ³•1: è®¾ç½®ä½ çš„ç”¨æˆ·ä¸ºç®¡ç†å‘˜
UPDATE users SET plan = 'admin' WHERE email = 'your-email@example.com';

-- æˆ–è€…æ–¹æ³•2: æ·»åŠ ç®¡ç†å‘˜é¡¹ç›®æƒé™
UPDATE users SET projects = array_append(projects, 'admin') WHERE email = 'your-email@example.com';
```

### 3. æµ‹è¯•åŠŸèƒ½
```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
node scripts/test-invite-codes.js

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆå¦‚æœè¿˜æ²¡è¿è¡Œï¼‰
npm run dev
```

### 4. ä½¿ç”¨åŠŸèƒ½
1. è®¿é—® `http://localhost:3000/admin/invite-codes` - ç®¡ç†é‚€è¯·ç 
2. è®¿é—® `http://localhost:3000/sign-up` - æµ‹è¯•æ³¨å†Œæµç¨‹

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### ç®¡ç†å‘˜åŠŸèƒ½
- âœ… ç”Ÿæˆé‚€è¯·ç ï¼ˆå•ä¸ª/æ‰¹é‡ï¼‰
- âœ… è®¾ç½®ä½¿ç”¨æ¬¡æ•°é™åˆ¶
- âœ… è®¾ç½®è¿‡æœŸæ—¶é—´
- âœ… é…ç½®ç”¨æˆ·æƒé™
- âœ… æŸ¥çœ‹ä½¿ç”¨ç»Ÿè®¡

### ç”¨æˆ·åŠŸèƒ½  
- âœ… é‚€è¯·ç éªŒè¯
- âœ… æ³¨å†Œæµç¨‹é›†æˆ
- âœ… è‡ªåŠ¨æƒé™åˆ†é…

### å®‰å…¨ç‰¹æ€§
- âœ… IP åœ°å€è®°å½•
- âœ… ä½¿ç”¨æ¬¡æ•°é™åˆ¶
- âœ… è¿‡æœŸæ—¶é—´æ§åˆ¶
- âœ… é‚®ç®±å”¯ä¸€æ€§éªŒè¯
- âœ… è¡Œçº§å®‰å…¨ç­–ç•¥

## ğŸ”§ API ç«¯ç‚¹

### å…¬å¼€ API
- `POST /api/invite-codes/verify` - éªŒè¯é‚€è¯·ç 
- `POST /api/invite-codes/use` - ä½¿ç”¨é‚€è¯·ç 

### ç®¡ç†å‘˜ API
- `POST /api/admin/invite-codes/generate` - ç”Ÿæˆé‚€è¯·ç 
- `GET /api/admin/invite-codes/generate` - è·å–é‚€è¯·ç åˆ—è¡¨
- `GET /api/admin/invite-codes/[id]` - è·å–è¯¦æƒ…
- `PATCH /api/admin/invite-codes/[id]` - æ›´æ–°é‚€è¯·ç 
- `DELETE /api/admin/invite-codes/[id]` - åˆ é™¤é‚€è¯·ç 

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é”™è¯¯
1. **æ•°ç»„è¯­æ³•é”™è¯¯**
   ```
   ERROR: 22P02: malformed array literal: "["admin"]"
   ```
   **è§£å†³**: ä½¿ç”¨ `sql/invite-codes-schema-fixed.sql`

2. **æ— æ³•è®¿é—®ç®¡ç†é¢æ¿**
   **è§£å†³**: æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰ç®¡ç†å‘˜æƒé™

3. **é‚€è¯·ç éªŒè¯å¤±è´¥**
   **è§£å†³**: æ£€æŸ¥é‚€è¯·ç æ ¼å¼å’Œæœ‰æ•ˆæœŸ

### æ£€æŸ¥æ¸…å•
- [ ] æ•°æ®åº“è¡¨å·²åˆ›å»º
- [ ] ç”¨æˆ·æœ‰ç®¡ç†å‘˜æƒé™
- [ ] ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
- [ ] å¼€å‘æœåŠ¡å™¨è¿è¡Œä¸­

## ğŸ“š å®Œæ•´æ–‡æ¡£
è¯¦ç»†æ–‡æ¡£è¯·å‚è€ƒ `docs/INVITE_CODES_SETUP.md`

---

ğŸ‰ **ç°åœ¨ä½ çš„ HeysMe é¡¹ç›®å·²ç»å…·å¤‡å®Œæ•´çš„å†…æµ‹é‚€è¯·ç åŠŸèƒ½ï¼**
