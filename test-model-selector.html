<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡å‹é€‰æ‹©å™¨æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
        }
        .success { border-color: #28a745; background: #f8fff9; }
        .error { border-color: #dc3545; background: #fff8f8; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        pre { background: #f8f9fa; padding: 15px; border-radius: 6px; overflow-x: auto; }
        .model-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .model-card {
            padding: 15px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            background: #f8f9fa;
        }
        .model-name { font-weight: bold; color: #007bff; }
        .model-desc { font-size: 0.9em; color: #666; margin-top: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– AIæ¨¡å‹é€‰æ‹©å™¨æµ‹è¯•</h1>
        <p>æµ‹è¯•æ–°æ·»åŠ çš„æ™ºè°±ã€Kimiå’Œé€šä¹‰åƒé—®æ¨¡å‹æ”¯æŒ</p>

        <div class="test-section">
            <h3>ğŸ“Š æ”¯æŒçš„AIæ¨¡å‹</h3>
            <div class="model-info" id="modelList">
                <!-- æ¨¡å‹åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ æœ¬åœ°å­˜å‚¨æµ‹è¯•</h3>
            <button onclick="testLocalStorage()">æµ‹è¯•æœ¬åœ°å­˜å‚¨</button>
            <button onclick="clearLocalStorage()">æ¸…é™¤å­˜å‚¨</button>
            <button onclick="loadStoredConfig()">åŠ è½½å­˜å‚¨é…ç½®</button>
            <pre id="storageResult"></pre>
        </div>

        <div class="test-section">
            <h3>ğŸ”‘ API Keyç®¡ç†æµ‹è¯•</h3>
            <div>
                <label>é€‰æ‹©æä¾›å•†: </label>
                <select id="providerSelect">
                    <option value="openai">OpenAI</option>
                    <option value="anthropic">Anthropic</option>
                    <option value="zhipu">æ™ºè°±AI</option>
                    <option value="moonshot">Kimi/æœˆä¹‹æš—é¢</option>
                    <option value="qwen">é€šä¹‰åƒé—®</option>
                    <option value="groq">Groq</option>
                </select>
            </div>
            <div style="margin: 10px 0;">
                <input type="password" id="apiKeyInput" placeholder="è¾“å…¥API Key" style="width: 300px; padding: 8px;">
                <button onclick="saveApiKey()">ä¿å­˜</button>
            </div>
            <pre id="apiKeyResult"></pre>
        </div>

        <div class="test-section">
            <h3>ğŸ“¡ æ¨¡å‹é…ç½®æµ‹è¯•</h3>
            <button onclick="testModelConfigs()">æµ‹è¯•æ‰€æœ‰æ¨¡å‹é…ç½®</button>
            <pre id="configResult"></pre>
        </div>
    </div>

    <script>
        // æ¨¡å‹é…ç½®æ•°æ®
        const MODEL_PROVIDERS = {
            openai: {
                name: 'OpenAI',
                icon: 'ğŸ¤–',
                models: ['gpt-4o', 'gpt-4o-mini', 'gpt-4-turbo']
            },
            anthropic: {
                name: 'Anthropic',
                icon: 'ğŸ§ ',
                models: ['claude-3-5-sonnet-20241022', 'claude-3-haiku-20240307']
            },
            zhipu: {
                name: 'æ™ºè°±AI',
                icon: 'ğŸ§ ',
                models: ['glm-4.5', 'glm-4.5-air', 'glm-4.5v', 'glm-z1-air']
            },
            moonshot: {
                name: 'Kimi (æœˆä¹‹æš—é¢)',
                icon: 'ğŸŒ™',
                models: ['kimi-k2', 'kimi-k2-0905-preview', 'moonshot-v1-128k']
            },
            qwen: {
                name: 'é€šä¹‰åƒé—®',
                icon: 'ğŸ”¥',
                models: ['qwen3-coder', 'qwen3-coder-plus', 'qwen3-32b', 'qwen2.5-omni']
            },
            groq: {
                name: 'Groq',
                icon: 'âš¡',
                models: ['llama-3.3-70b-versatile', 'mixtral-8x7b-32768']
            }
        };

        // æ˜¾ç¤ºæ¨¡å‹åˆ—è¡¨
        function displayModels() {
            const container = document.getElementById('modelList');
            let html = '';
            
            Object.entries(MODEL_PROVIDERS).forEach(([key, provider]) => {
                html += `
                    <div class="model-card">
                        <div class="model-name">${provider.icon} ${provider.name}</div>
                        <div class="model-desc">
                            ${provider.models.length} ä¸ªæ¨¡å‹ï¼š${provider.models.slice(0, 2).join(', ')}${provider.models.length > 2 ? '...' : ''}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // æµ‹è¯•æœ¬åœ°å­˜å‚¨
        function testLocalStorage() {
            const testConfig = {
                provider: 'zhipu',
                model: 'glm-4.5',
                timestamp: new Date().toISOString()
            };
            
            try {
                localStorage.setItem('heysme-model-config', JSON.stringify(testConfig));
                
                const testKeys = {
                    zhipu: 'test_zhipu_key_' + Date.now(),
                    moonshot: 'test_moonshot_key_' + Date.now(),
                    qwen: 'test_qwen_key_' + Date.now()
                };
                localStorage.setItem('heysme-api-keys', JSON.stringify(testKeys));
                
                document.getElementById('storageResult').textContent = 
                    'âœ… æœ¬åœ°å­˜å‚¨æµ‹è¯•æˆåŠŸ\n' +
                    'ä¿å­˜çš„æ¨¡å‹é…ç½®: ' + JSON.stringify(testConfig, null, 2) + '\n' +
                    'ä¿å­˜çš„API Keys: ' + JSON.stringify(testKeys, null, 2);
            } catch (e) {
                document.getElementById('storageResult').textContent = 'âŒ æœ¬åœ°å­˜å‚¨æµ‹è¯•å¤±è´¥: ' + e.message;
            }
        }

        // æ¸…é™¤æœ¬åœ°å­˜å‚¨
        function clearLocalStorage() {
            localStorage.removeItem('heysme-model-config');
            localStorage.removeItem('heysme-api-keys');
            document.getElementById('storageResult').textContent = 'ğŸ—‘ï¸ æœ¬åœ°å­˜å‚¨å·²æ¸…é™¤';
        }

        // åŠ è½½å­˜å‚¨çš„é…ç½®
        function loadStoredConfig() {
            try {
                const modelConfig = localStorage.getItem('heysme-model-config');
                const apiKeys = localStorage.getItem('heysme-api-keys');
                
                const result = {
                    modelConfig: modelConfig ? JSON.parse(modelConfig) : null,
                    apiKeys: apiKeys ? JSON.parse(apiKeys) : null
                };
                
                document.getElementById('storageResult').textContent = 
                    'ğŸ“– å½“å‰å­˜å‚¨çš„é…ç½®:\n' + JSON.stringify(result, null, 2);
            } catch (e) {
                document.getElementById('storageResult').textContent = 'âŒ åŠ è½½é…ç½®å¤±è´¥: ' + e.message;
            }
        }

        // ä¿å­˜API Key
        function saveApiKey() {
            const provider = document.getElementById('providerSelect').value;
            const apiKey = document.getElementById('apiKeyInput').value;
            
            if (!apiKey.trim()) {
                document.getElementById('apiKeyResult').textContent = 'âŒ è¯·è¾“å…¥API Key';
                return;
            }
            
            try {
                let existingKeys = {};
                const stored = localStorage.getItem('heysme-api-keys');
                if (stored) {
                    existingKeys = JSON.parse(stored);
                }
                
                existingKeys[provider] = apiKey;
                localStorage.setItem('heysme-api-keys', JSON.stringify(existingKeys));
                
                // æ¸…é™¤è¾“å…¥
                document.getElementById('apiKeyInput').value = '';
                
                document.getElementById('apiKeyResult').textContent = 
                    `âœ… ${provider} API Key ä¿å­˜æˆåŠŸ\n` +
                    'å½“å‰æ‰€æœ‰Keys: ' + Object.keys(existingKeys).join(', ');
            } catch (e) {
                document.getElementById('apiKeyResult').textContent = 'âŒ ä¿å­˜å¤±è´¥: ' + e.message;
            }
        }

        // æµ‹è¯•æ¨¡å‹é…ç½®
        function testModelConfigs() {
            const results = [];
            
            Object.entries(MODEL_PROVIDERS).forEach(([provider, config]) => {
                config.models.forEach(model => {
                    const testConfig = {
                        provider,
                        model,
                        baseURL: getBaseURL(provider),
                        status: 'âœ… é…ç½®æ­£ç¡®'
                    };
                    results.push(testConfig);
                });
            });
            
            document.getElementById('configResult').textContent = 
                'ğŸ§ª æ¨¡å‹é…ç½®æµ‹è¯•ç»“æœ:\n' + 
                results.map(r => `${r.provider}/${r.model} - ${r.status}`).join('\n');
        }

        // è·å–åŸºç¡€URL
        function getBaseURL(provider) {
            const urls = {
                openai: 'https://api.openai.com/v1',
                anthropic: 'https://api.anthropic.com/v1',
                zhipu: 'https://open.bigmodel.cn/api/paas/v4',
                moonshot: 'https://api.moonshot.cn/v1',
                qwen: 'https://dashscope.aliyuncs.com/compatible-mode/v1',
                groq: 'https://api.groq.com/openai/v1'
            };
            return urls[provider] || 'æœªçŸ¥';
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºæ¨¡å‹
        displayModels();
        
        // æ·»åŠ ä¸€äº›æ ·å¼å¢å¼º
        console.log('ğŸš€ HeysMe AIæ¨¡å‹é€‰æ‹©å™¨æµ‹è¯•é¡µé¢å·²åŠ è½½');
        console.log('ğŸ“Š æ”¯æŒçš„æä¾›å•†:', Object.keys(MODEL_PROVIDERS));
        console.log('ğŸ“± æ€»æ¨¡å‹æ•°:', Object.values(MODEL_PROVIDERS).reduce((sum, p) => sum + p.models.length, 0));
    </script>
</body>
</html>
